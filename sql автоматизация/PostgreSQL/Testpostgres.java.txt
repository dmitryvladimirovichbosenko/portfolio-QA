package db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class TestPostgres {
    public static void main(String[] args) {
        // üëâ –ü–æ–º–µ–Ω—è–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–º—è –ë–î/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–ø–∞—Ä–æ–ª—å
        String url = "jdbc:postgresql://localhost:5432/postgres?sslmode=disable";
        String user = "postgres";
        String password = "1234";

        try (Connection conn = DriverManager.getConnection(url, user, password)) {
            System.out.println("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —É—Å–ø–µ—à–Ω–æ!");

            try (Statement stmt = conn.createStatement()) {
                // 1) –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—É–¥–∞–ª–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
                stmt.executeUpdate("""
                        CREATE TEMP TABLE qa_demo_temp (
                            id    SERIAL PRIMARY KEY,
                            title TEXT NOT NULL
                        )
                        """);
                System.out.println("üì¶ –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ qa_demo_temp —Å–æ–∑–¥–∞–Ω–∞.");

                // 2) –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                stmt.executeUpdate("""
                        INSERT INTO qa_demo_temp(title)
                        VALUES ('Hello PostgreSQL'), ('Second row')
                        """);
                System.out.println("‚úèÔ∏è –î–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.");

                // 3) –í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
                try (ResultSet rs = stmt.executeQuery("""
                        SELECT id, title
                        FROM qa_demo_temp
                        ORDER BY id
                        """)) {
                    System.out.println("\nüìÑ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ qa_demo_temp:");
                    while (rs.next()) {
                        int id = rs.getInt("id");
                        String title = rs.getString("title");
                        System.out.println(id + ": " + title);
                    }
                }
            }

            System.out.println("\nüßπ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏—Å—á–µ–∑–Ω–µ—Ç.");
        } catch (Exception e) {
            System.out.println("‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î:");
            e.printStackTrace();
        }
    }
}
